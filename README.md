# TractographyMetrics
Evaluation of tractograms using diffusion and geometrical metrics.

## Functionality

With this tool you will be able to compute and view in a fast and compact way multiple statistics about a fiber bundle.
For each stats the value representing the mean, median and standard deviation are computed, as well as the maximum and
minimum extremities. Allowing the progress of studies based on descriptive statistics and objective information.

The stats currently supported are:

* **Bundle Proprieties**
    * Number of fibers
    * Number of points
* **Geometrical Proprieties**
    * Lengths
    * Shortest path
    * Turning angle
* **Connectivity Proprieties**
    * Seeds position
    * Termination position
    * Mid-point position
* **Diffusion Proprieties**
    * b-zero intensity
    * FA value
    * MD value
    
Additionaly, a seamless 3DSlicer integrations enables an interactive and immediate fiber analysis, complemented
by behaviour graphs. 

## Installation and Usage.

To set up TractographyMetrics the first thing you need to do is obtaining a copy of it.

To download TractographyMetrics the first thing you should do is open a terminal and move to the directory where you want it to
be installed.

For example, for an installation in the desktop of a MacOS system write:
```sh
$ cd /User/youraccountname/Desktop
```

Get a copy using git:
```sh
$ git clone https://github.com/aledelmo/TractographyMetrics
```

Enter in your freshly downloaded folder:
```sh
$ cd TractographyMetrics
```

Some dependencies are required for a smooth experience. To install everything needed, simply run:
```sh
$ pip install -r requirements.txt
```

Dependencies: **dipy**, **VTK**, **XlsxWriter** <br />
Python3 Compatibility Dependencies: **future**, **six** <br />

Get the tractogram generated by your favourite software and run:
```sh
$ python -m tractography_metrics.py <tractogram_filepath> <output_txt_file> <query_filepath>
```

You should now be able to find all the stats that you were looking for in your newly created text file.

To add diffusion information to the analysis make use of the following optional keywords:

| short flag | long flag | Action |
| ------ | ------ | ------ |
| ```-bzero <filepath>``` | ```--b_zero <filepath>``` | Compute stats on the bzero volume  |
| ```-fa <metric_filepath>``` | ```--Fractional_Anisotropy <metric_filepath>``` | Compute stats on the FA metric volume |
| ```-md <metric_filepath>``` | ```--metric_filepath``` | Compute stats on the MD metric volume |

If you prefer to have yout output in a different format use the optional flags:

| short flag | long flag |
| ------ | ------ |
| ```-csv``` | ```--save_csv``` |
| ```-xlsx``` | ```--save_xlsx``` |

These allows to obtain, respectively, a CSV and an Excel output file

Additionally, tu further customize your output with an header use:

| short flag | long flag | Action |
| ------ | ------ | ------ |
| ```-hd <text>``` | ```--header <text>``` | Add any string of text to the stats |

If you are working on huge amount of fibers and you are experiencing computational time issues you can try to
downsampling the tractogram:

| short flag | long flag | Action |
| ------ | ------ | ------ |
| ```-r <resampling_percentage>``` | ```--resample <resampling_percentage>``` | Specify the percentage of downsampling of the tractogram fibers (value between 0 and 100) |

To update the tool, once entered in the folder using a terminal, use the command:
 ```sh
$ git pull
```

It is very important to keep the tool up-to-date to always receive the bug-fixes and to enable the newly developed
functionality.

## Development

###### New Features !!!

  - Now compatible for 3DSlicer 4.9.*
  
###### Todos:

 - Plots in Python interpreter
 
 License
----

Apache License 2.0
